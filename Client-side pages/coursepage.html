<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses - School Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: #2c3e50;
            color: white;
            padding: 1rem 0;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background 0.3s;
        }

        .nav-links a:hover, .nav-links a.active {
            background: #34495e;
        }

        .page-title {
            background: white;
            padding: 2rem 0;
            text-align: center;
        }

        .page-title h1 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .content {
            padding: 2rem 0;
        }

        .actions {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .search-box {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }

        .search-box input {
            flex: 1;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-success:hover {
            background: #229954;
        }

        .courses-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #34495e;
            color: white;
            font-weight: bold;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.9rem;
        }

        .btn-warning {
            background: #f39c12;
        }

        .btn-warning:hover {
            background: #d68910;
        }

        .btn-danger {
            background: #e74c3c;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .status-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            overflow: auto;
        }

        .modal.show {
            display: block;
        }

        .modal-content {
            background: white;
            margin: 3% auto;
            padding: 2rem;
            border-radius: 8px;
            max-width: 600px;
            position: relative;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
        }

        .modal-header h2 {
            color: #2c3e50;
        }

        .close {
            font-size: 2rem;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close:hover {
            color: #e74c3c;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .required {
            color: #e74c3c;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        .form-group input.valid,
        .form-group select.valid {
            border-color: #27ae60;
            background: #f0fff4;
        }

        .form-group input.invalid,
        .form-group select.invalid {
            border-color: #e74c3c;
            background: #fff5f5;
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 0.3rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            color: #27ae60;
            font-size: 0.9rem;
            margin-top: 0.3rem;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-cancel {
            background: #95a5a6;
        }

        .btn-cancel:hover {
            background: #7f8c8d;
        }

        .alert {
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                gap: 0.5rem;
            }

            .search-box {
                flex-direction: column;
                align-items: stretch;
            }

            .courses-table {
                overflow-x: auto;
            }

            table {
                min-width: 700px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 0.3rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">EduTrack</div>
            <ul class="nav-links">
                <li><a href="homepage.html">Home</a></li>
                <li><a href="studentpage.html">Students</a></li>
                <li><a href="teacherpage.html">Teachers</a></li>
                <li><a href="coursepage.html" class="active">Courses</a></li>
                <li><a href="contactpage.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <section class="page-title">
        <div class="container">
            <h1>Course Management</h1>
            <p>Manage all courses and subjects</p>
        </div>
    </section>

    <main class="content">
        <div class="container">
            <div id="alertBox" class="alert"></div>

            <div class="actions">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search courses by name or code...">
                    <button class="btn" onclick="searchCourses()">Search</button>
                </div>
                <button class="btn btn-success" onclick="openAddModal()">Add New Course</button>
            </div>

            <div class="courses-table">
                <table>
                    <thead>
                        <tr>
                            <th>Course Code</th>
                            <th>Course Name</th>
                            <th>Teacher</th>
                            <th>Duration</th>
                            <th>Students</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="courseTableBody">
                        <!-- Courses will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <div id="courseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Course</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>

            <form id="courseForm" novalidate>
                <input type="hidden" id="courseIndex">

                <div class="form-group">
                    <label for="courseCode">Course Code <span class="required">*</span></label>
                    <input type="text" id="courseCode" name="courseCode" placeholder="e.g., MATH101">
                    <span class="error-message" id="courseCodeError"></span>
                    <span class="success-message" id="courseCodeSuccess">✓ Valid code</span>
                </div>

                <div class="form-group">
                    <label for="courseName">Course Name <span class="required">*</span></label>
                    <input type="text" id="courseName" name="courseName" placeholder="Enter course name">
                    <span class="error-message" id="courseNameError"></span>
                    <span class="success-message" id="courseNameSuccess">✓ Valid name</span>
                </div>

                <div class="form-group">
                    <label for="courseTeacher">Teacher <span class="required">*</span></label>
                    <select id="courseTeacher" name="courseTeacher">
                        <option value="">Select Teacher</option>
                        <option value="Shweta Ramani">Shweta Ramani</option>
                        <option value="Drashti Chovatiya">Drashti Chovatiya</option>
                        <option value="Ajay Pachani">Ajay Pachani</option>
                        <option value="Kishan Mavani">Kishan Mavani</option>
                        <option value="Bhargav Thaker">Bhargav Thaker</option>
                    </select>
                    <span class="error-message" id="courseTeacherError"></span>
                    <span class="success-message" id="courseTeacherSuccess">✓ Selected</span>
                </div>

                <div class="form-group">
                    <label for="courseDuration">Duration <span class="required">*</span></label>
                    <select id="courseDuration" name="courseDuration">
                        <option value="">Select Duration</option>
                        <option value="1 Semester">1 Semester</option>
                        <option value="2 Semesters">2 Semesters</option>
                        <option value="1 Year">1 Year</option>
                        <option value="2 Years">2 Years</option>
                    </select>
                    <span class="error-message" id="courseDurationError"></span>
                    <span class="success-message" id="courseDurationSuccess">✓ Selected</span>
                </div>

                <div class="form-group">
                    <label for="courseStudents">Number of Students <span class="required">*</span></label>
                    <input type="number" id="courseStudents" name="courseStudents" placeholder="Enter number" min="0" max="100">
                    <span class="error-message" id="courseStudentsError"></span>
                    <span class="success-message" id="courseStudentsSuccess">✓ Valid</span>
                </div>

                <div class="form-group">
                    <label for="courseStatus">Status <span class="required">*</span></label>
                    <select id="courseStatus" name="courseStatus">
                        <option value="">Select Status</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                    <span class="error-message" id="courseStatusError"></span>
                    <span class="success-message" id="courseStatusSuccess">✓ Selected</span>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-success">Save Course</button>
                    <button type="button" class="btn btn-cancel" onclick="closeModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 EduTrack. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Course data
        let courses = [
            { code: 'MATH101', name: 'Advanced Mathematics', teacher: 'Shweta Ramani', duration: '1 Semester', students: 25, status: 'Active' },
            { code: 'ENG102', name: 'English Literature', teacher: 'Drashti Chovatiya', duration: '1 Year', students: 30, status: 'Active' },
            { code: 'PHY103', name: 'Physics Fundamentals', teacher: 'Ajay Pachani', duration: '1 Semester', students: 22, status: 'Active' },
            { code: 'CHEM104', name: 'Organic Chemistry', teacher: 'Kishan Mavani', duration: '1 Semester', students: 18, status: 'Inactive' },
            { code: 'BIO105', name: 'Biology Basics', teacher: 'Bhargav Thaker', duration: '1 Year', students: 28, status: 'Active' }
        ];

        let isEditMode = false;
        let editIndex = -1;

        // Render courses
        function renderCourses(filteredCourses = courses) {
            const tbody = document.getElementById('courseTableBody');
            tbody.innerHTML = '';

            if (filteredCourses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:2rem;">No courses found</td></tr>';
                return;
            }

            filteredCourses.forEach((course) => {
                const row = document.createElement('tr');
                const statusClass = course.status === 'Active' ? 'status-active' : 'status-inactive';
                const originalIndex = courses.indexOf(course);
                
                row.innerHTML = `
                    <td>${course.code}</td>
                    <td>${course.name}</td>
                    <td>${course.teacher}</td>
                    <td>${course.duration}</td>
                    <td>${course.students}</td>
                    <td><span class="status-badge ${statusClass}">${course.status}</span></td>
                    <td class="action-buttons">
                        <button class="btn btn-small" onclick="viewCourse(${originalIndex})">View</button>
                        <button class="btn btn-warning btn-small" onclick="editCourse(${originalIndex})">Edit</button>
                        <button class="btn btn-danger btn-small" onclick="deleteCourse(${originalIndex})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function searchCourses() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            if (searchTerm === '') {
                renderCourses();
                return;
            }
            const filtered = courses.filter(course =>
                course.name.toLowerCase().includes(searchTerm) ||
                course.code.toLowerCase().includes(searchTerm) ||
                course.teacher.toLowerCase().includes(searchTerm)
            );
            renderCourses(filtered);
        }

        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') searchCourses();
        });

        function openAddModal() {
            isEditMode = false;
            document.getElementById('modalTitle').textContent = 'Add New Course';
            document.getElementById('courseForm').reset();
            clearAllValidation();
            document.getElementById('courseModal').classList.add('show');
        }

        function editCourse(index) {
            isEditMode = true;
            editIndex = index;
            const course = courses[index];
            document.getElementById('modalTitle').textContent = 'Edit Course';
            document.getElementById('courseIndex').value = index;
            document.getElementById('courseCode').value = course.code;
            document.getElementById('courseName').value = course.name;
            document.getElementById('courseTeacher').value = course.teacher;
            document.getElementById('courseDuration').value = course.duration;
            document.getElementById('courseStudents').value = course.students;
            document.getElementById('courseStatus').value = course.status;
            clearAllValidation();
            document.getElementById('courseModal').classList.add('show');
        }

        function viewCourse(index) {
            const c = courses[index];
            alert(`Course Details:\n\nCode: ${c.code}\nName: ${c.name}\nTeacher: ${c.teacher}\nDuration: ${c.duration}\nStudents: ${c.students}\nStatus: ${c.status}`);
        }

        function deleteCourse(index) {
            const c = courses[index];
            if (confirm(`Delete ${c.name}?`)) {
                courses.splice(index, 1);
                renderCourses();
                showAlert('Course deleted successfully!', 'success');
            }
        }

        function closeModal() {
            document.getElementById('courseModal').classList.remove('show');
            document.getElementById('courseForm').reset();
            clearAllValidation();
        }

        window.onclick = function(event) {
            const modal = document.getElementById('courseModal');
            if (event.target === modal) closeModal();
        };

        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.textContent = message;
            alertBox.className = 'alert show alert-' + type;
            setTimeout(() => alertBox.classList.remove('show'), 5000);
        }

        function showError(input, message) {
            const errorElement = document.getElementById(input.id + 'Error');
            const successElement = document.getElementById(input.id + 'Success');
            input.classList.add('invalid');
            input.classList.remove('valid');
            errorElement.textContent = message;
            errorElement.classList.add('show');
            if (successElement) successElement.classList.remove('show');
        }

        function showSuccess(input) {
            const errorElement = document.getElementById(input.id + 'Error');
            const successElement = document.getElementById(input.id + 'Success');
            input.classList.add('valid');
            input.classList.remove('invalid');
            errorElement.classList.remove('show');
            if (successElement) successElement.classList.add('show');
        }

        function clearValidation(input) {
            const errorElement = document.getElementById(input.id + 'Error');
            const successElement = document.getElementById(input.id + 'Success');
            input.classList.remove('valid', 'invalid');
            if (errorElement) errorElement.classList.remove('show');
            if (successElement) successElement.classList.remove('show');
        }

        function clearAllValidation() {
            ['courseCode', 'courseName', 'courseTeacher', 'courseDuration', 'courseStudents', 'courseStatus'].forEach(id => {
                const input = document.getElementById(id);
                if (input) clearValidation(input);
            });
        }

        function validateCourseCode() {
            const input = document.getElementById('courseCode');
            const value = input.value.trim().toUpperCase();
            if (value === '') {
                showError(input, 'Course code is required');
                return false;
            }
            if (!/^[A-Z]{3,4}\d{3}$/.test(value)) {
                showError(input, 'Format: 3-4 letters + 3 digits (e.g., MATH101)');
                return false;
            }
            const isDuplicate = courses.some((course, index) => 
                course.code === value && (!isEditMode || index !== editIndex)
            );
            if (isDuplicate) {
                showError(input, 'This course code already exists');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function validateCourseName() {
            const input = document.getElementById('courseName');
            const value = input.value.trim();
            if (value === '') {
                showError(input, 'Course name is required');
                return false;
            }
            if (value.length < 3) {
                showError(input, 'Name must be at least 3 characters');
                return false;
            }
            if (value.length > 100) {
                showError(input, 'Name must be less than 100 characters');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function validateCourseTeacher() {
            const input = document.getElementById('courseTeacher');
            if (input.value === '') {
                showError(input, 'Please select a teacher');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function validateCourseDuration() {
            const input = document.getElementById('courseDuration');
            if (input.value === '') {
                showError(input, 'Please select duration');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function validateCourseStudents() {
            const input = document.getElementById('courseStudents');
            const value = input.value.trim();
            if (value === '') {
                showError(input, 'Number of students is required');
                return false;
            }
            const students = parseInt(value);
            if (isNaN(students) || students < 0) {
                showError(input, 'Must be a positive number');
                return false;
            }
            if (students > 100) {
                showError(input, 'Cannot exceed 100 students');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function validateCourseStatus() {
            const input = document.getElementById('courseStatus');
            if (input.value === '') {
                showError(input, 'Please select status');
                return false;
            }
            showSuccess(input);
            return true;
        }

        function setupValidation() {
            const fields = {
                courseCode: validateCourseCode,
                courseName: validateCourseName,
                courseTeacher: validateCourseTeacher,
                courseDuration: validateCourseDuration,
                courseStudents: validateCourseStudents,
                courseStatus: validateCourseStatus
            };

            Object.keys(fields).forEach(id => {
                const input = document.getElementById(id);
                input.addEventListener('blur', fields[id]);
                input.addEventListener('input', () => clearValidation(input));
            });

            document.getElementById('courseCode').addEventListener('input', function() {
                this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
            });

            document.getElementById('courseStudents').addEventListener('input', function() {
                if (this.value < 0) this.value = 0;
                if (this.value > 100) this.value = 100;
            });
        }

        document.getElementById('courseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const validations = [
                validateCourseCode(),
                validateCourseName(),
                validateCourseTeacher(),
                validateCourseDuration(),
                validateCourseStudents(),
                validateCourseStatus()
            ];

            if (validations.every(v => v)) {
                const courseData = {
                    code: document.getElementById('courseCode').value.trim().toUpperCase(),
                    name: document.getElementById('courseName').value.trim(),
                    teacher: document.getElementById('courseTeacher').value,
                    duration: document.getElementById('courseDuration').value,
                    students: parseInt(document.getElementById('courseStudents').value),
                    status: document.getElementById('courseStatus').value
                };

                if (isEditMode) {
                    courses[editIndex] = courseData;
                    showAlert('Course updated successfully!', 'success');
                } else {
                    courses.push(courseData);
                    showAlert('Course added successfully!', 'success');
                }

                renderCourses();
                closeModal();
            } else {
                showAlert('Please fix all errors', 'error');
            }
        });

        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            console.log('Loading courses...');
            renderCourses();
            setupValidation();
            console.log('Courses loaded:', courses.length);
        });
    </script>
</body>
</html>